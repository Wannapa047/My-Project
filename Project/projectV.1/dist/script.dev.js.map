{"version":3,"sources":["script.js"],"names":["videoElement","document","querySelector","canvasElement","outputText","getElementById","canvasCtx","getContext","holistic","Holistic","locateFile","file","setOptions","modelComplexity","smoothLandmarks","enableSegmentation","smoothSegmentation","refineFaceLandmarks","minDetectionConfidence","minTrackingConfidence","onResults","model","loadModel","tf","loadLayersModel","console","log","error","results","clearRect","width","height","drawImage","image","rightHandLandmarks","landmarks","map","point","x","y","z","predictGesture","warn","inputTensor","tensor","flat","reshape","prediction","predict","gestureIndex","argMax","dataSync","gestureLabels","innerText","dispose","setupCamera","camera","Camera","onFrame","send","start","loadScripts","scripts","src","Promise","resolve","reject","script","createElement","onload","onerror","body","appendChild","window"],"mappings":"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","sourcesContent":["// โหลด MediaPipe Holistic แบบปกติ (ไม่ต้องใช้ import)\r\nconst videoElement = document.querySelector(\".input_video\");\r\nconst canvasElement = document.querySelector(\".output_canvas\");\r\nconst outputText = document.getElementById(\"outputText\");\r\nconst canvasCtx = canvasElement.getContext(\"2d\");\r\n\r\n// โหลด Mediapipe Holistic\r\nconst holistic = new Holistic({\r\n    locateFile: (file) => `https://cdn.jsdelivr.net/npm/@mediapipe/holistic/${file}`\r\n});\r\n\r\nholistic.setOptions({\r\n    modelComplexity: 1,\r\n    smoothLandmarks: true,\r\n    enableSegmentation: true,\r\n    smoothSegmentation: true,\r\n    refineFaceLandmarks: true,\r\n    minDetectionConfidence: 0.5,\r\n    minTrackingConfidence: 0.5,\r\n});\r\n\r\nholistic.onResults(onResults);\r\n\r\n// โหลดโมเดล TensorFlow.js\r\nlet model;\r\nasync function loadModel() {\r\n    try {\r\n        model = await tf.loadLayersModel(\"models/model.json\"); // แก้ path ให้ตรง\r\n        console.log(\"✅ Model Loaded Successfully!\");\r\n    } catch (error) {\r\n        console.error(\"❌ Failed to load model:\", error);\r\n    }\r\n}\r\n\r\n// ฟังก์ชันประมวลผลผลลัพธ์\r\nfunction onResults(results) {\r\n    canvasCtx.clearRect(0, 0, canvasElement.width, canvasElement.height);\r\n    canvasCtx.drawImage(results.image, 0, 0, canvasElement.width, canvasElement.height);\r\n\r\n    if (results.rightHandLandmarks) {\r\n        const landmarks = results.rightHandLandmarks.map(point => [point.x, point.y, point.z]);\r\n        predictGesture(landmarks);\r\n    }\r\n}\r\n\r\n// ฟังก์ชันทำนายท่าทางมือ\r\nasync function predictGesture(landmarks) {\r\n    if (!model) {\r\n        console.warn(\"⚠️ Model is not loaded yet.\");\r\n        return;\r\n    }\r\n\r\n    const inputTensor = tf.tensor([landmarks.flat()]).reshape([1, 63]); // 21 จุด * (x, y, z)\r\n    const prediction = model.predict(inputTensor);\r\n    const gestureIndex = prediction.argMax(-1).dataSync()[0];\r\n\r\n    const gestureLabels = [\"สวัสดี\", \"ขอบคุณ\", \"รัก\"]; // แก้ตามชุดข้อมูลที่ใช้ train\r\n    outputText.innerText = gestureLabels[gestureIndex] || \"ไม่รู้จัก\";\r\n\r\n    inputTensor.dispose();\r\n    prediction.dispose();\r\n}\r\n\r\n// เริ่มใช้งานกล้อง\r\nasync function setupCamera() {\r\n    const camera = new Camera(videoElement, {\r\n        onFrame: async () => {\r\n            await holistic.send({ image: videoElement });\r\n        },\r\n        width: 640,\r\n        height: 480\r\n    });\r\n\r\n    camera.start();\r\n}\r\n\r\n// โหลดสคริปต์ Mediapipe และ TensorFlow\r\nasync function loadScripts() {\r\n    const scripts = [\r\n        \"https://cdn.jsdelivr.net/npm/@mediapipe/holistic/holistic.js\",\r\n        \"https://cdn.jsdelivr.net/npm/@tensorflow/tfjs\",\r\n        \"https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js\"\r\n    ];\r\n\r\n    for (const src of scripts) {\r\n        await new Promise((resolve, reject) => {\r\n            const script = document.createElement(\"script\");\r\n            script.src = src;\r\n            script.onload = resolve;\r\n            script.onerror = reject;\r\n            document.body.appendChild(script);\r\n        });\r\n    }\r\n\r\n    console.log(\"✅ All scripts loaded!\");\r\n    await loadModel();\r\n    setupCamera();\r\n}\r\n\r\n// โหลดทุกอย่างเมื่อหน้าเว็บโหลดเสร็จ\r\nwindow.onload = loadScripts;\r\n"],"file":"script.dev.js"}