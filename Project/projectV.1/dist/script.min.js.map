{"version":3,"sources":["script.js"],"names":["model","videoElement","document","querySelector","canvasElement","holistic","Holistic","file","concat","loadModel","regeneratorRuntime","async","_context","prev","next","awrap","tf","loadLayersModel","sent","console","log","t0","error","stop","onResults","results","width","height","canvasCtx","drawImage","image","rightHandLandmarks","predictGesture","map","point","x","y","z","landmarks","inputTensor","prediction","gestureIndex","gestureLabels","_context2","warn","abrupt","tensor","flat","reshape","predict","argMax","dataSync","clearRect","dispose","Camera","onFrame","_context3","send","start","loadScripts","_loop","_i","_scripts","_context6","src","_context5","Promise","resolve","reject","createElement","script","onerror","outputText","innerText","length","setupCamera","setOptions","modelComplexity","smoothLandmarks","enableSegmentation","smoothSegmentation","refineFaceLandmarks","window","onload"],"mappings":"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","file":"script.min.js","sourcesContent":["// โหลด MediaPipe Holistic แบบปกติ (ไม่ต้องใช้ import)\r\nconst videoElement = document.querySelector(\".input_video\");\r\nconst canvasElement = document.querySelector(\".output_canvas\");\r\nconst outputText = document.getElementById(\"outputText\");\r\nconst canvasCtx = canvasElement.getContext(\"2d\");\r\n\r\n// โหลด Mediapipe Holistic\r\nconst holistic = new Holistic({\r\n    locateFile: (file) => `https://cdn.jsdelivr.net/npm/@mediapipe/holistic/${file}`\r\n});\r\n\r\nholistic.setOptions({\r\n    modelComplexity: 1,\r\n    smoothLandmarks: true,\r\n    enableSegmentation: true,\r\n    smoothSegmentation: true,\r\n    refineFaceLandmarks: true,\r\n    minDetectionConfidence: 0.5,\r\n    minTrackingConfidence: 0.5,\r\n});\r\n\r\nholistic.onResults(onResults);\r\n\r\n// โหลดโมเดล TensorFlow.js\r\nlet model;\r\nasync function loadModel() {\r\n    try {\r\n        model = await tf.loadLayersModel(\"models/model.json\"); // แก้ path ให้ตรง\r\n        console.log(\"✅ Model Loaded Successfully!\");\r\n    } catch (error) {\r\n        console.error(\"❌ Failed to load model:\", error);\r\n    }\r\n}\r\n\r\n// ฟังก์ชันประมวลผลผลลัพธ์\r\nfunction onResults(results) {\r\n    canvasCtx.clearRect(0, 0, canvasElement.width, canvasElement.height);\r\n    canvasCtx.drawImage(results.image, 0, 0, canvasElement.width, canvasElement.height);\r\n\r\n    if (results.rightHandLandmarks) {\r\n        const landmarks = results.rightHandLandmarks.map(point => [point.x, point.y, point.z]);\r\n        predictGesture(landmarks);\r\n    }\r\n}\r\n\r\n// ฟังก์ชันทำนายท่าทางมือ\r\nasync function predictGesture(landmarks) {\r\n    if (!model) {\r\n        console.warn(\"⚠️ Model is not loaded yet.\");\r\n        return;\r\n    }\r\n\r\n    const inputTensor = tf.tensor([landmarks.flat()]).reshape([1, 63]); // 21 จุด * (x, y, z)\r\n    const prediction = model.predict(inputTensor);\r\n    const gestureIndex = prediction.argMax(-1).dataSync()[0];\r\n\r\n    const gestureLabels = [\"สวัสดี\", \"ขอบคุณ\", \"รัก\"]; // แก้ตามชุดข้อมูลที่ใช้ train\r\n    outputText.innerText = gestureLabels[gestureIndex] || \"ไม่รู้จัก\";\r\n\r\n    inputTensor.dispose();\r\n    prediction.dispose();\r\n}\r\n\r\n// เริ่มใช้งานกล้อง\r\nasync function setupCamera() {\r\n    const camera = new Camera(videoElement, {\r\n        onFrame: async () => {\r\n            await holistic.send({ image: videoElement });\r\n        },\r\n        width: 640,\r\n        height: 480\r\n    });\r\n\r\n    camera.start();\r\n}\r\n\r\n// โหลดสคริปต์ Mediapipe และ TensorFlow\r\nasync function loadScripts() {\r\n    const scripts = [\r\n        \"https://cdn.jsdelivr.net/npm/@mediapipe/holistic/holistic.js\",\r\n        \"https://cdn.jsdelivr.net/npm/@tensorflow/tfjs\",\r\n        \"https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js\"\r\n    ];\r\n\r\n    for (const src of scripts) {\r\n        await new Promise((resolve, reject) => {\r\n            const script = document.createElement(\"script\");\r\n            script.src = src;\r\n            script.onload = resolve;\r\n            script.onerror = reject;\r\n            document.body.appendChild(script);\r\n        });\r\n    }\r\n\r\n    console.log(\"✅ All scripts loaded!\");\r\n    await loadModel();\r\n    setupCamera();\r\n}\r\n\r\n// โหลดทุกอย่างเมื่อหน้าเว็บโหลดเสร็จ\r\nwindow.onload = loadScripts;\r\n"]}